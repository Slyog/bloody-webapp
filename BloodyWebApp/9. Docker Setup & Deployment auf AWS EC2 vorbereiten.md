---
title: "Schritt 7 ‚Äì Docker Setup & Deployment auf AWS EC2 vorbereiten"
tags: [Docker, AWS, Deployment, DevOps, EC2, NextJS, MongoDB]
date: 2025-10-18
aliases: [Docker Deployment, EC2 Setup, Schritt 7, NextJS Deployment]
---

# üê≥ Schritt 7: Docker Setup & Deployment auf AWS EC2 vorbereiten

üéØ **Ziel:**  
Deine Next.js-App soll in einem **Docker-Container** laufen und auf einer **AWS EC2-Instance** deployt werden.  
Das macht dein Projekt **portabel**, **sicher** und **cloud-ready**.

---

## ‚öôÔ∏è 1Ô∏è‚É£ Voraussetzungen auf EC2 pr√ºfen

Deine EC2-Instanz (Amazon Linux 2 oder 2023) sollte laufen.  
Ports 22 (SSH) und 80 (HTTP) m√ºssen in der **Security Group** offen sein.

### SSH-Verbindung herstellen:

```bash
ssh -i dein-key.pem ec2-user@<deine-ec2-ip>
```


Dann pr√ºfen:

`sudo yum update -y sudo systemctl status docker`

Wenn Docker nicht installiert ist:

`sudo yum install docker -y sudo systemctl enable docker sudo systemctl start docker sudo usermod -aG docker ec2-user`

Abmelden und neu verbinden, damit die Berechtigung aktiv wird.

---

## üß© 2Ô∏è‚É£ Dockerfile im Projekt anlegen

Erstelle im Root deines Projekts (`webapp/`) eine Datei `Dockerfile`:

`# Basis-Image FROM node:20-alpine  # Arbeitsverzeichnis im Container WORKDIR /app  # Dependencies installieren COPY package*.json ./ RUN npm install  # Restlichen Code kopieren COPY . .  # App f√ºr Produktion bauen RUN npm run build  # App starten EXPOSE 3000 CMD ["npm", "start"]`

---

## ‚öôÔ∏è 3Ô∏è‚É£ Docker Compose (optional, f√ºr lokale MongoDB & Next.js)

Wenn du MongoDB lokal oder in Docker laufen l√§sst, erstelle `docker-compose.yml`:

`version: '3.9' services:   webapp:     build: .     container_name: bloodyark-webapp     ports:       - "3000:3000"     env_file:       - .env     depends_on:       - mongo    mongo:     image: mongo:latest     container_name: bloodyark-mongo     restart: always     ports:       - "27017:27017"     volumes:       - mongo_data:/data/db  volumes:   mongo_data:`

Starte beides lokal:

`docker compose up --build`

‚Üí √ñffne [http://localhost:3000](http://localhost:3000)  
Wenn du deine App siehst, l√§uft alles richtig.

---

## üß† 4Ô∏è‚É£ .dockerignore hinzuf√ºgen

Damit keine unn√∂tigen Dateien in das Image kopiert werden:

`node_modules .next .git Dockerfile docker-compose.yml *.log .env`

---

## ‚òÅÔ∏è 5Ô∏è‚É£ Docker Image bauen & testen

### Lokal:

`docker build -t bloodyark-webapp . 
docker run -d -p 3000:3000 bloodyark-webapp`

### Logs pr√ºfen:

`docker ps docker logs -f <container_id>`

Wenn alles l√§uft, stoppe den Container wieder:

`docker stop <container_id>`

---

## ‚òÅÔ∏è 6Ô∏è‚É£ Deployment auf EC2

### Option A: Code via Git pull

1Ô∏è‚É£ Auf deiner EC2:

`git clone https://github.com/<USER>/<REPO>.git cd <REPO>`

2Ô∏è‚É£ Docker starten:

`sudo systemctl start docker docker build -t bloodyark-webapp . docker run -d -p 80:3000 bloodyark-webapp`

‚Üí App l√§uft jetzt auf  
**http://<deine-ec2-ip>**

---

### Option B: Upload mit SCP (wenn du kein Git nutzt)

`scp -i dein-key.pem -r ./webapp ec2-user@<ec2-ip>:/home/ec2-user/`

Dann auf der EC2:

`cd webapp docker build -t bloodyark-webapp . docker run -d -p 80:3000 bloodyark-webapp`

---

## üß© 7Ô∏è‚É£ Umgebung & Variablen (.env)

Lege im Projekt eine `.env`-Datei an:

`MONGODB_URI=mongodb://mongo:27017/bloodyarkdb NODE_ENV=production PORT=3000`

Im Dockerfile wird diese Datei automatisch durch `env_file` geladen.

---

## üß† 8Ô∏è‚É£ N√ºtzliche Docker-Kommandos

|Aufgabe|Befehl|
|---|---|
|Container anzeigen|`docker ps -a`|
|Container stoppen|`docker stop <id>`|
|Container l√∂schen|`docker rm <id>`|
|Images anzeigen|`docker images`|
|Image l√∂schen|`docker rmi <name>`|
|Alle stoppen & l√∂schen|`docker stop $(docker ps -aq) && docker rm $(docker ps -aq)`|

---

## üöÄ 9Ô∏è‚É£ Optional: AWS Integration mit ECR (Elastic Container Registry)

Wenn du deine Images **in der Cloud speichern** willst:

`aws ecr create-repository --repository-name bloodyark-webapp aws ecr get-login-password --region eu-central-1 | docker login --username AWS --password-stdin <account-id>.dkr.ecr.eu-central-1.amazonaws.com docker tag bloodyark-webapp:latest <account-id>.dkr.ecr.eu-central-1.amazonaws.com/bloodyark-webapp:latest docker push <account-id>.dkr.ecr.eu-central-1.amazonaws.com/bloodyark-webapp:latest`

Sp√§ter kannst du das Image direkt in ECS, EC2 oder Fargate deployen.